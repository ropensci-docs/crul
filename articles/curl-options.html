<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="crul">
<title>4. curl options • crul</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4. curl options">
<meta property="og:description" content="crul">
<meta property="og:image" content="https://docs.ropensci.org/crul/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">crul</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/crul.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/async.html">3. async with crul</a>
    <a class="dropdown-item" href="../articles/best-practices-api-packages.html">5. API package best practices</a>
    <a class="dropdown-item" href="../articles/choosing-a-client.html">6. Choosing a HTTP request class</a>
    <a class="dropdown-item" href="../articles/curl-options.html">4. curl options</a>
    <a class="dropdown-item" href="../articles/how-to-use-crul.html">2. crul workflows</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/crul/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>4. curl options</h1>
                        <h4 data-toc-skip class="author">Scott Chamberlain</h4>
            
            <h4 data-toc-skip class="date">2023-05-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/crul/blob/HEAD/vignettes/curl-options.Rmd" class="external-link"><code>vignettes/curl-options.Rmd</code></a></small>
      <div class="d-none name"><code>curl-options.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>adapted in part from the blog post <a href="https://ropensci.org/blog/2014/12/18/curl-options/" class="external-link">Curling - exploring web request options</a></p>
</blockquote>
<p>Most times you request data from the web, you should have no problem. However, you eventually will run into problems. In addition, there are advanced things you can do modifying requests to web resources that fall in the <em>advanced stuff</em> category.</p>
<p>Requests to web resources are served over the <code>http</code> protocol via <a href="https://curl.se/" class="external-link">curl</a>. <code>curl</code> <em>is a command line tool and library for transferring data with URL syntax, supporting (lots of protocols)</em> . <code>curl</code> has many options that you may not know about.</p>
<p>I’ll go over some of the common and less commonly used curl options, and try to explain why you may want to use some of them.</p>
<div class="section level2">
<h2 id="discover-curl-options">Discover curl options<a class="anchor" aria-label="anchor" href="#discover-curl-options"></a>
</h2>
<p>You can go to the source, that is the curl book at <a href="https://everything.curl.dev/" class="external-link uri">https://everything.curl.dev/</a>. In R: <code><a href="https://rdrr.io/pkg/curl/man/curl_options.html" class="external-link">curl::curl_options()</a></code> for finding curl options. which gives information for each curl option, including the libcurl variable name (e.g., <code>CURLOPT_CERTINFO</code>) and the type of variable (e.g., logical).</p>
</div>
<div class="section level2">
<h2 id="other-ways-to-use-curl-besides-r">Other ways to use curl besides R<a class="anchor" aria-label="anchor" href="#other-ways-to-use-curl-besides-r"></a>
</h2>
<p>Perhaps the canonical way to use curl is on the command line. You can get curl for your operating system at <a href="https://curl.se/download.html" class="external-link uri">https://curl.se/download.html</a>, though hopefully you already have curl. Once you have curl, you can have lots of fun. For example, get the contents of the Google landing page:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://www.google.com</span></code></pre></div>
<ul>
<li>If you like that you may also like <a href="https://github.com/httpie/httpie" class="external-link">httpie</a>, a Python command line tool that is a little more convenient than curl (e.g., JSON output is automatically parsed and colorized).</li>
<li>Alot of data from the web is in JSON format. A great command line tool to pair with <code>curl</code> is <a href="https://stedolan.github.io/jq/" class="external-link">jq</a>.</li>
</ul>
<blockquote>
<p>Note: if you are on windows you may require extra setup if you want to play with curl on the command line. OSX and linux have it by default. On Windows 8, installing the latest version from here <a href="https://curl.se/download.html#Win64" class="external-link uri">https://curl.se/download.html#Win64</a> worked for me.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="general-info">general info<a class="anchor" aria-label="anchor" href="#general-info"></a>
</h2>
<p>With <code>crul</code> you have to set curl options per each object, so not globally across all HTTP requests. We may allow the global curl option setting in the future.</p>
</div>
<div class="section level2">
<h2 id="using-curl-options-in-other-packages">using curl options in other packages<a class="anchor" aria-label="anchor" href="#using-curl-options-in-other-packages"></a>
</h2>
<p>We recommend using <code>...</code> to allow users to pass in curl options. For example, lets say you have a function in a package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">crul</span><span class="fu">::</span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="va">yoururl</span><span class="op">)</span></span>
<span>  <span class="va">z</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To make it easy for users to pass in curl options use an <code>...</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">crul</span><span class="fu">::</span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="va">yoururl</span>, opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">z</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then we can pass in any combination of acceptable curl options:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">foo</span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; verbose curl output</span></span></code></pre></div>
<p>You can instead make users pass in a list, e.g.:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">opts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">crul</span><span class="fu">::</span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="va">yoururl</span>, opts <span class="op">=</span> <span class="va">opts</span><span class="op">)</span></span>
<span>  <span class="va">z</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then a user has to pass curl options like:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">foo</span><span class="op">(</span>opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="timeout">timeout<a class="anchor" aria-label="anchor" href="#timeout"></a>
</h2>
<blockquote>
<p>Set a timeout for a request. If request exceeds timeout, request stops.</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code>timeout_ms=&lt;integer&gt;</code></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://www.google.com/search"</span>, </span>
<span>  opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>timeout_ms <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in curl::curl_fetch_memory(x$url$url, handle = x$url$handle) :</span></span>
<span><span class="co">#&gt;  Timeout was reached: Operation timed out after 35 milliseconds with 0 bytes received</span></span></code></pre></div>
<p><em>Why use this?</em> You sometimes are working with a web resource that is somewhat unreliable. For example, if you want to run a script on a server that may take many hours, and the web resource could be down at some point during that time, you could set the timeout and error catch the response so that the script doesn’t hang on a server that’s not responding. Another example could be if you call a web resource in an R package. In your test suite, you may want to test that a web resource is responding quickly, so you could set a timeout, and not test if that fails.</p>
</div>
<div class="section level2">
<h2 id="verbose">verbose<a class="anchor" aria-label="anchor" href="#verbose"></a>
</h2>
<blockquote>
<p>Print detailed info on a curl call</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code>verbose=&lt;boolean&gt;</code></li>
</ul>
<p>Just do a <code>HEAD</code> request so we don’t have to deal with big output</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://hb.opencpu.org"</span>, </span>
<span>  opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt; HEAD / HTTP/1.1</span></span>
<span><span class="co">#&gt; Host: hb.opencpu.org</span></span>
<span><span class="co">#&gt; User-Agent: libcurl/7.54.0 r-curl/3.2 crul/0.5.4.9521</span></span>
<span><span class="co">#&gt; Accept: */*</span></span>
<span><span class="co">#&gt; Accept-Encoding: gzip, deflate</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &lt; HTTP/1.1 200 OK</span></span>
<span><span class="co">#&gt; &lt; Connection: keep-alive</span></span>
<span><span class="co">#&gt; &lt; Server: gunicorn/19.8.1</span></span>
<span><span class="co">#&gt; &lt; Date: Fri, 06 Jul 2018 17:56:50 GMT</span></span>
<span><span class="co">#&gt; &lt; Content-Type: text/html; charset=utf-8</span></span>
<span><span class="co">#&gt; &lt; Content-Length: 8344</span></span>
<span><span class="co">#&gt; &lt; Access-Control-Allow-Origin: *</span></span>
<span><span class="co">#&gt; &lt; Access-Control-Allow-Credentials: true</span></span>
<span><span class="co">#&gt; &lt; Via: 1.1 vegur</span></span></code></pre></div>
<p><em>Why use this?</em> As you can see verbose output gives you lots of information that may be useful for debugging a request. You typically don’t need verbose output unless you want to inspect a request.</p>
</div>
<div class="section level2">
<h2 id="headers">headers<a class="anchor" aria-label="anchor" href="#headers"></a>
</h2>
<blockquote>
<p>Add headers to modify requests, including authentication, setting content-type, accept type, etc.</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code>HttpClient$new(headers = list(...))</code></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://hb.opencpu.org"</span>, </span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Accept <span class="op">=</span> <span class="st">"application/json"</span>, </span>
<span>    foo <span class="op">=</span> <span class="st">"bar"</span></span>
<span>  <span class="op">)</span>, </span>
<span>  opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt; HEAD / HTTP/1.1</span></span>
<span><span class="co">#&gt; Host: hb.opencpu.org</span></span>
<span><span class="co">#&gt; User-Agent: libcurl/7.54.0 r-curl/3.2 crul/0.5.4.9521</span></span>
<span><span class="co">#&gt; Accept-Encoding: gzip, deflate</span></span>
<span><span class="co">#&gt; Accept: application/json</span></span>
<span><span class="co">#&gt; foo: bar</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &lt; HTTP/1.1 200 OK</span></span>
<span><span class="co">#&gt; &lt; Connection: keep-alive</span></span>
<span><span class="co">#&gt; &lt; Server: gunicorn/19.8.1</span></span>
<span><span class="co">#&gt; &lt; Date: Fri, 06 Jul 2018 17:59:15 GMT</span></span>
<span><span class="co">#&gt; &lt; Content-Type: text/html; charset=utf-8</span></span>
<span><span class="co">#&gt; &lt; Content-Length: 8344</span></span>
<span><span class="co">#&gt; &lt; Access-Control-Allow-Origin: *</span></span>
<span><span class="co">#&gt; &lt; Access-Control-Allow-Credentials: true</span></span>
<span><span class="co">#&gt; &lt; Via: 1.1 vegur</span></span></code></pre></div>
<p><em>Why use this?</em> For some web resources, using headers is mandatory, and <code>httr</code> makes including them quite easy. Headers are nice too because e.g., passing authentication in the header instead of the URL string means your private data is not as exposed to prying eyes.</p>
</div>
<div class="section level2">
<h2 id="authenticate">authenticate<a class="anchor" aria-label="anchor" href="#authenticate"></a>
</h2>
<blockquote>
<p>Set authentication details for a resource</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code><a href="../reference/auth.html">auth()</a></code></li>
</ul>
<p><code><a href="../reference/auth.html">auth()</a></code> for basic username/password authentication</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/auth.html">auth</a></span><span class="op">(</span>user <span class="op">=</span> <span class="st">"foo"</span>, pwd <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $userpwd</span></span>
<span><span class="co">#&gt; [1] "foo:bar"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $httpauth</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "auth"</span></span>
<span><span class="co">#&gt; attr(,"type")</span></span>
<span><span class="co">#&gt; [1] "basic"</span></span></code></pre></div>
<p>To use an API key, this depends on the data provider. They may request it one or either of the header</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://hb.opencpu.org/get"</span>, headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Authorization <span class="op">=</span> <span class="st">"Bearer 234kqhrlj2342"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>or as a query parameter (which is passed in the URL string)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://hb.opencpu.org/get"</span>, query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>api_key <span class="op">=</span> <span class="st">"&lt;your key&gt;"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Another authentication option is OAuth. OAuth is not supported in <code>crul</code> yet. You can always do OAuth with <code>httr</code> and then take your token and pass it in as a header/etc. with <code>crul</code>.</p>
</div>
<div class="section level2">
<h2 id="cookies">cookies<a class="anchor" aria-label="anchor" href="#cookies"></a>
</h2>
<blockquote>
<p>Set or get cookies.</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code><a href="../reference/auth.html">auth()</a></code></li>
</ul>
<p>Set cookies (just showing response headers)</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://www.google.com"</span>, opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt; HTTP/1.1 200 OK</span></span>
<span><span class="co">#&gt; &lt; Date: Fri, 06 Jul 2018 23:25:49 GMT</span></span>
<span><span class="co">#&gt; &lt; Expires: -1</span></span>
<span><span class="co">#&gt; &lt; Cache-Control: private, max-age=0</span></span>
<span><span class="co">#&gt; &lt; Content-Type: text/html; charset=ISO-8859-1</span></span>
<span><span class="co">#&gt; &lt; P3P: CP="This is not a P3P policy! See g.co/p3phelp for more info."</span></span>
<span><span class="co">#&gt; &lt; Content-Encoding: gzip</span></span>
<span><span class="co">#&gt; &lt; Server: gws</span></span>
<span><span class="co">#&gt; &lt; X-XSS-Protection: 1; mode=block</span></span>
<span><span class="co">#&gt; &lt; X-Frame-Options: SAMEORIGIN</span></span>
<span><span class="co">#&gt; * Added cookie 1P_JAR="2018-07-06-23" for domain google.com, path /, expire 1533511549</span></span>
<span><span class="co">#&gt; &lt; Set-Cookie: 1P_JAR=2018-07-06-23; expires=Sun, 05-Aug-2018 23:25:49 GMT; path=/; domain=.google.com</span></span>
<span><span class="co">#&gt; * Added cookie NID="134=yt47WC-2mhTgQpkSCMz_ySTig3MCJD5Bx_lNj_aVLAwKu8SPMX-CCowKfU8zSv2cJ2OjiX2LTrYnhWMGvIDieCC419v0VHvlm4Hl9xln9-r4MZwcnqwTZQPT72VNE0uA" for domain google.com, path /, expire 1546730749</span></span>
<span><span class="co">#&gt; &lt; Set-Cookie: NID=134=yt47WC-2mhTgQpkSCMz_ySTig3MCJD5Bx_lNj_aVLAwKu8SPMX-CCowKfU8zSv2cJ2OjiX2LTrYnhWMGvIDieCC419v0VHvlm4Hl9xln9-r4MZwcnqwTZQPT72VNE0uA; expires=Sat, 05-Jan-2019 23:25:49 GMT; path=/; domain=.google.com; HttpOnly</span></span>
<span><span class="co">#&gt; &lt; Alt-Svc: quic=":443"; ma=2592000; v="43,42,41,39,35"</span></span>
<span><span class="co">#&gt; &lt; Transfer-Encoding: chunked</span></span></code></pre></div>
<p>If there are cookies in a response, you can access them with <code><a href="https://rdrr.io/pkg/curl/man/handle_cookies.html" class="external-link">curl::handle_cookies</a></code> like:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">curl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curl/man/handle_cookies.html" class="external-link">handle_cookies</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">handle</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  domain flag path secure          expiration   name</span></span>
<span><span class="co">#&gt; 1           .google.com TRUE    /  FALSE 2018-08-05 16:25:16 1P_JAR</span></span>
<span><span class="co">#&gt; 2 #HttpOnly_.google.com TRUE    /  FALSE 2019-01-05 15:25:16    NID</span></span>
<span><span class="co">#&gt;   value</span></span>
<span><span class="co">#&gt; 1 2018-07-06-23</span></span>
<span><span class="co">#&gt; 2 134=4E_Zo-cY8hRLNSj47jRJQML0CPQ8Ip__ ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="progress">progress<a class="anchor" aria-label="anchor" href="#progress"></a>
</h2>
<blockquote>
<p>Print curl progress</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code>HttpClient$new(progress = fxn)</code></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://hb.opencpu.org/get"</span>, progress <span class="op">=</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/progress.html" class="external-link">progress</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; |==================================| 100%</span></span></code></pre></div>
<p><em>Why use this?</em> As you could imagine, this is increasingly useful as a request for a web resource takes longer and longer. For very long requests, this will help you know approximately when a request will finish.</p>
</div>
<div class="section level2">
<h2 id="proxies">proxies<a class="anchor" aria-label="anchor" href="#proxies"></a>
</h2>
<blockquote>
<p>When behind a proxy, give authentication details for your proxy.</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li><code>HttpClient$new(proxies = proxy("http://97.77.104.22:3128", "foo", "bar"))</code></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/proxies.html">proxy</a></span><span class="op">(</span><span class="st">"125.39.66.66"</span>, port <span class="op">=</span> <span class="fl">80</span>, username <span class="op">=</span> <span class="st">"username"</span>, password <span class="op">=</span> <span class="st">"password"</span><span class="op">)</span></span>
<span><span class="va"><a href="../reference/HttpClient.html">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"http://www.google.com/search"</span>, proxies <span class="op">=</span> <span class="va">prox</span><span class="op">)</span></span></code></pre></div>
<p><em>Why use this?</em> Most of us likely don’t need to worry about this. However, if you are in a work place, or maybe in certain geographic locations, you may have to use a proxy. I haven’t personally used a proxy in R, so any feedback on this is great.</p>
</div>
<div class="section level2">
<h2 id="user-agent">user agent<a class="anchor" aria-label="anchor" href="#user-agent"></a>
</h2>
<blockquote>
<p>Some resources require a user-agent string.</p>
</blockquote>
<p>relevant commands:</p>
<ul>
<li>
<code>HttpClient$new(headers = list(</code>User-Agent<code>= "foobar"))</code> OR</li>
<li><code>HttpClient$new(opts = list(useragent = "foobar"))</code></li>
</ul>
<p>both result in the same thing</p>
<p><em>Why use this?</em> This is set by default in a http request, as you can see in the first example above for user agent. Some web APIs require that you set a specific user agent. For example, the <a href="https://developer.github.com/v3/#user-agent-required" class="external-link">GitHub API</a> requires that you include a user agent string in the header of each request that is your username or the name of your application so they can contact you if there is a problem.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
